<!DOCTYPE html>                            <html>                                <head>                                    <meta charset="UTF-8">                                    <title>SW_16_Výběr dat v SQL</title>                                    <link rel="stylesheet" href="./style/style.css">                                    <link rel="stylesheet" href="./style/kimbie.dark.css">                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">                                    (27,31,35,.05);border-radius:3px;font-size:1rem}.markdown-content ul li pre,.manual ul li pre,pre{margin:0;direction:ltr!important}.markdown-content ul li pre code,.manual ul li pre code,pre code{direction:ltr!important;line-height:1.45;padding:1em 0 .5em 3em;position:relative;display:block;overflow-x:auto;overflow-y:auto}a{text-decoration:none}.title{float:left;color:#ccc}.markdown-container{padding-top:60px}.elements{padding:12px;position:fixed;top:0;right:0;left:0;background-color:#444;height:50px;z-index:1}.input{color:#fff}#savebutton,input{font-size:15px}#savebutton{padding:0 7px!important}#rtl-checkbox-container{margin:3px 15px!important;color:#fff}.button{background-color:#fff;color:#444;font-size:1.6rem;display:inline-block;text-align:center;line-height:2.1rem;border-radius:2px}.button:hover{cursor:pointer;background-color:#eee}#refresh-button{width:2.2rem;vertical-align:middle}@media print{.no-print,.no-print *{display:none!important}}.hljs-comment,.hljs-quote{color:#99ac5b}.hljs-meta,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#dc3958}.hljs-built_in,.hljs-builtin-name,.hljs-deletion,.hljs-link,.hljs-literal,.hljs-number,.hljs-params,.hljs-type{color:#f79a32}.hljs-attribute,.hljs-section,.hljs-title{color:#f06431}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#9c9}.hljs-function,.hljs-keyword,.hljs-selector-tag{color:#98676a}.hljs{display:block;overflow-x:auto;background:#221a0f;color:#d3af86}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}                                </head>                                <body><div class="markdown-container ltr"><div class="markdown-content"><h1 id="sw-16-v-b-r-dat-v-sql">SW 16 – Výběr dat v SQL</h1>
<h2 id="select">SELECT</h2>
<ul>
<li>Příkaz <code>SELECT</code> se v SQL používá k získání jakýchkoliv informací z databáze</li>
<li>Vrací množinu záznamů z jedné nebo více tabulek</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> seznam sloupců <span class="hljs-comment">-- * = všechny, jinak odděleno čárkami</span>
<span class="hljs-keyword">FROM</span> seznam tabulek 
<span class="hljs-keyword">WHERE</span> restrikce
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> seskupit dle
<span class="hljs-keyword">HAVING</span> restrikce
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dle čeho řadit;
</code></pre>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID (PK)</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">Valterri</td>
<td style="text-align:center">1989</td>
<td style="text-align:center">Finland</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Carlos</td>
<td style="text-align:center">1975</td>
<td style="text-align:center">Spain</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Ariana</td>
<td style="text-align:center">1999</td>
<td style="text-align:center">Italy</td>
</tr>
</tbody>
</table>
<h2 id="projekce">Projekce</h2>
<ul>
<li>Určení dat, které se mají vybrat – výběr konkrétních sloupců</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">Name</span>, Country <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">3</span>;
<span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">3</span> <span class="hljs-keyword">Name</span>, Country <span class="hljs-keyword">FROM</span> Customers; <span class="hljs-comment">-- jiný dialekt</span>
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Valterri</td>
<td style="text-align:center">Finland</td>
</tr>
<tr>
<td style="text-align:center">Arno</td>
<td style="text-align:center">France</td>
</tr>
<tr>
<td style="text-align:center">Carlos</td>
<td style="text-align:center">Spain</td>
</tr>
</tbody>
</table>
<h2 id="restrikce">Restrikce</h2>
<ul>
<li>Výběr (omezování) řádků při výběru dat z tabulky</li>
<li>Podmínky, které musí být splněny, aby byl řádek zahrnut v návratovém řetězci SELECTu</li>
<li>Logické výrazy; spojky <code>AND</code>, <code>OR</code>, <code>NOT</code>; závorky</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> CustomerID &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> CustomerID &lt;= <span class="hljs-number">3</span>;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> CustomerID <span class="hljs-keyword">IN</span>(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID (PK)</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Carlos</td>
<td style="text-align:center">1975</td>
<td style="text-align:center">Spain</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> Country = <span class="hljs-string">"Italy"</span>;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID (PK)</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Ariana</td>
<td style="text-align:center">1999</td>
<td style="text-align:center">Italy</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Operátor <code>LIKE</code> porovnává řetězce, podporuje jednoduché výrazy (~regex)</p>
<ul>
<li><code>%</code> – Libovolný počet znaků</li>
<li><p><code>_</code> – Libovolný znak</p>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> Country <span class="hljs-keyword">LIKE</span> <span class="hljs-string">"F%"</span>;
</code></pre>
<p>CustomerID (PK) | Name | BirthYear | Country
:-: | :-: | :-: | :-:
1 | Valterri | 1989 | Finland
2 | Arno | 1768 | France</p>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> Country <span class="hljs-keyword">LIKE</span> <span class="hljs-string">"__a__"</span>;
</code></pre>
<p>CustomerID (PK) | Name | BirthYear | Country
:-: | :-: | :-: | :-:
3 | Carlos | 1975 | Spain
4 | Ezio | 1459 | Italy
5 | Ariana | 1999 | Italy</p>
</li>
</ul>
</li>
</ul>
<h2 id="agregace">Agregace</h2>
<ul>
<li>Agregační funkce slouží k provádění matematických operací s vybranými daty a vrací výsledky daných operací</li>
<li><code>MIN</code> – minimální hodnota</li>
<li><code>MAX</code> – maximální hodnota</li>
<li><code>AVG</code> – průměrná hodnota</li>
<li><code>SUM</code> – suma</li>
<li><code>COUNT</code> – počet</li>
<li><code>ROUND</code> – zaokrouhlení</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MIN</span>(BirthYear) <span class="hljs-keyword">AS</span> Oldest <span class="hljs-keyword">FROM</span> Customers;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">Oldest</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1459</td>
<td></td>
</tr>
</tbody>
</table>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">WHERE</span> BirthYear = (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MIN</span>(BirthYear) <span class="hljs-keyword">FROM</span> Customers);
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID (PK)</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(CustomerID) <span class="hljs-keyword">FROM</span> Customers; <span class="hljs-comment">-- 5</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(BirthYear) <span class="hljs-keyword">FROM</span> Customers; <span class="hljs-comment">-- 1838</span>
</code></pre>
<h2 id="seskupen-">Seskupení</h2>
<ul>
<li>Provádí se podle hodnot určitých sloupců</li>
<li>Když se objeví více řádků, které se v určitém sloupci shodují, databázový systém na ně bude pohlížet jako na jeden řádek</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> Country, <span class="hljs-keyword">COUNT</span>(CustomerID) <span class="hljs-comment">-- Běžně vybíráme to, podle čeho se bude seskupovat + agregační fce</span>
<span class="hljs-keyword">FROM</span> Customers
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Country
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">COUNT</span>(CustomerID) <span class="hljs-keyword">DESC</span>; <span class="hljs-comment">-- Seřadit dle ..., DESC = sestupně</span>
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">Country</th>
<th style="text-align:center">COUNT(CustomerID)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Italy</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">Findland</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">France</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">Spain</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<h3 id="having">HAVING</h3>
<ul>
<li><code>HAVING</code> byl přidán do SQL, protože <code>WHERE</code> nelze použít s agregačními funkcemi</li>
<li>Dá se chápat jako druhý <code>WHERE</code>, píše se za <code>GROUP BY</code></li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> Country, <span class="hljs-keyword">COUNT</span>(CustomerID)
<span class="hljs-keyword">FROM</span> Customers
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Country
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(CustomerID) &gt; <span class="hljs-number">1</span>;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">Country</th>
<th style="text-align:center">COUNT(CustomerID)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Italy</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<h2 id="spojov-n-tabulek">Spojování tabulek</h2>
<ul>
<li>Podstata relačních databází spočívá v rozdělení informací do několika navzájem propojených tabulek (přes klíče PK–FK)</li>
<li>Pomocí příkazu <code>JOIN</code> lze spojit dvě tabulky do jedné</li>
<li><code>INNER JOIN</code> – vrací řádky, kde se klíče shodují v obou tabulkách</li>
<li><code>LEFT (OUTER) JOIN</code> – vrací všechny řádky z levé tabulky, ke každému z nich přiřadí shodující se řádek z pravé tabulky nebo NULL (pokud neexistuje pravá vazba)</li>
<li><code>RIGHT (OUTER) JOIN</code> – ~obrácený LEFT JOIN</li>
<li><code>FULL (OUTER) JOIN</code> – vrací řádky z obou tabulek, doplňuje NULL při neexistující vazbě.</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Orders;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">OrderID (PK)</th>
<th style="text-align:center">CustomerID (FK)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:center">NULL (např. neregistrovaný zákazník)</td>
</tr>
<tr>
<td style="text-align:center">102</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">103</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">104</td>
<td style="text-align:center">4</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> Customers <span class="hljs-keyword">INNER</span>/<span class="hljs-keyword">LEFT</span>/<span class="hljs-keyword">RIGHT</span>/<span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> Orders <span class="hljs-keyword">ON</span> Customers.CustomerID = Orders.CustomerID;
</code></pre>
<h3 id="inner-join">INNER JOIN</h3>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
<th style="text-align:center">OrderID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
<td style="text-align:center">102</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">103</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">104</td>
</tr>
</tbody>
</table>
<h3 id="left-join">LEFT JOIN</h3>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
<th style="text-align:center">OrderID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">Valterri</td>
<td style="text-align:center">1989</td>
<td style="text-align:center">Finland</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
<td style="text-align:center">102</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Carlos</td>
<td style="text-align:center">1975</td>
<td style="text-align:center">Spain</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">103</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">104</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Ariana</td>
<td style="text-align:center">1999</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h3 id="right-join">RIGHT JOIN</h3>
<table>
<thead>
<tr>
<th style="text-align:center">OrderID</th>
<th style="text-align:center">CustomerID</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">102</td>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
</tr>
<tr>
<td style="text-align:center">103</td>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
</tr>
<tr>
<td style="text-align:center">104</td>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
</tr>
</tbody>
</table>
<h3 id="full-outer-join">FULL OUTER JOIN</h3>
<table>
<thead>
<tr>
<th style="text-align:center">CustomerID</th>
<th style="text-align:center">Name</th>
<th style="text-align:center">BirthYear</th>
<th style="text-align:center">Country</th>
<th style="text-align:center">OrderID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">Valterri</td>
<td style="text-align:center">1989</td>
<td style="text-align:center">Finland</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Arno</td>
<td style="text-align:center">1768</td>
<td style="text-align:center">France</td>
<td style="text-align:center">102</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Carlos</td>
<td style="text-align:center">1975</td>
<td style="text-align:center">Spain</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">103</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Ezio</td>
<td style="text-align:center">1459</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center">104</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Ariana</td>
<td style="text-align:center">1999</td>
<td style="text-align:center">Italy</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>101</td>
</tr>
</tbody>
</table>
<h2 id="union">UNION</h2>
<ul>
<li>Propojuje dvě množiny výsledků dotazů a odstraňuje duplicity</li>
<li><code>UNION ALL</code> duplicity neodstraňuje</li>
<li>Každý propojený <code>SELECT</code> musí vracet stejný počet sloupců (ideálně i stejný název a datový typ)</li>
</ul>
<pre><code class="lang-sql hljs "><span class="hljs-keyword">SELECT</span> sloupce <span class="hljs-keyword">FROM</span> tabulka1
<span class="hljs-keyword">UNION</span> (ALL)
<span class="hljs-keyword">SELECT</span> sloupce <span class="hljs-keyword">FROM</span> tabulka2;
</code></pre>
<h2 id="-">---</h2>
<p><img src="img/SW_16_01.png" alt="Joins"></p>
</div></div></body>                            </html>