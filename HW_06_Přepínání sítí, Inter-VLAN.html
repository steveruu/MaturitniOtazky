<!DOCTYPE html>                            <html>                                <head>                                    <meta charset="UTF-8">                                    <title>HW_06_Přepínání sítí, Inter-VLAN</title>                                    <link rel="stylesheet" href="./style/style.css">                                    <link rel="stylesheet" href="./style/kimbie.dark.css">                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">                                    (27,31,35,.05);border-radius:3px;font-size:1rem}.markdown-content ul li pre,.manual ul li pre,pre{margin:0;direction:ltr!important}.markdown-content ul li pre code,.manual ul li pre code,pre code{direction:ltr!important;line-height:1.45;padding:1em 0 .5em 3em;position:relative;display:block;overflow-x:auto;overflow-y:auto}a{text-decoration:none}.title{float:left;color:#ccc}.markdown-container{padding-top:60px}.elements{padding:12px;position:fixed;top:0;right:0;left:0;background-color:#444;height:50px;z-index:1}.input{color:#fff}#savebutton,input{font-size:15px}#savebutton{padding:0 7px!important}#rtl-checkbox-container{margin:3px 15px!important;color:#fff}.button{background-color:#fff;color:#444;font-size:1.6rem;display:inline-block;text-align:center;line-height:2.1rem;border-radius:2px}.button:hover{cursor:pointer;background-color:#eee}#refresh-button{width:2.2rem;vertical-align:middle}@media print{.no-print,.no-print *{display:none!important}}.hljs-comment,.hljs-quote{color:#99ac5b}.hljs-meta,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#dc3958}.hljs-built_in,.hljs-builtin-name,.hljs-deletion,.hljs-link,.hljs-literal,.hljs-number,.hljs-params,.hljs-type{color:#f79a32}.hljs-attribute,.hljs-section,.hljs-title{color:#f06431}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#9c9}.hljs-function,.hljs-keyword,.hljs-selector-tag{color:#98676a}.hljs{display:block;overflow-x:auto;background:#221a0f;color:#d3af86}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}                                </head>                                <body><div class="markdown-container ltr"><div class="markdown-content"><h1 id="hw-06-p-ep-n-n-s-t-inter-vlan">HW 06 – Přepínání sítí, Inter-VLAN</h1>
<h2 id="inter-vlan-routing">Inter-VLAN routing</h2>
<ul>
<li>Po rozdělení sítě na VLAN se zmenší broadcastové domény, segmentuje se síť a ušetří se např. za hardware</li>
<li>Aby mohli mezi sebou jednotlivé VLAN komunikovat, musí se mezi nimi routovat</li>
<li>To se nazývá <em>inter-VLAN routing</em> a jsou tři běžné způsoby:</li>
</ul>
<h2 id="legacy">Legacy</h2>
<p><img src="./img/HW_06_01.PNG" alt="legacy"></p>
<ul>
<li>Jednotlivé VLAN, které chceme routovat, se vyvedou do samostatných access portů a ty se připojí k samostatným portům směrovače</li>
<li>Každá VLAN je připojena jedním fyzickým rozhraním, každý port směrovače má přiřazenou jednu VLAN</li>
<li>Nevýhodou je potřeba více portů (podle počtu VLAN)</li>
<li>Směrovač na bázi SW je bottleneckem pro rychlé přepínače na bázi HW</li>
</ul>
<h2 id="router-on-a-stick-vyu-vaj-c-trunk-">Router on a stick (využívající trunk)</h2>
<p><img src="./img/HW_06_02.PNG" alt="routeronastick"></p>
<ul>
<li>Trunk mezi směrovačem a přepínačem</li>
</ul>
<pre><code class="lang-txt hljs "><span class="hljs-keyword">Switch</span>(config)<span class="hljs-comment"># interface gigabitEthernet 0/0/0</span>
<span class="hljs-keyword">Switch</span>(config-<span class="hljs-keyword">if</span>)<span class="hljs-comment"># no sh                                        // Zapnutí interface</span>
<span class="hljs-keyword">Switch</span>(config-<span class="hljs-keyword">if</span>)<span class="hljs-comment"># exi</span>
<span class="hljs-keyword">Switch</span>(config)<span class="hljs-comment"># interface gigabitEthernet 0/0/0.10              // Vytvoření a zapnutí subinterface</span>
<span class="hljs-keyword">Switch</span>(config-subif)<span class="hljs-comment"># encapsulation dot1Q 10                    // Subinterface 10 odpovídá VLAN 10</span>
<span class="hljs-keyword">Switch</span>(config-subif)<span class="hljs-comment"># ip address 172.17.30.1 255.255.255.0</span>
</code></pre>
<ul>
<li>Číslo subinterface a číslo VLAN se nemusí shodovat, je to ale doporučeno</li>
<li>Každá VLAN má svůj subinterface</li>
<li>Kromě <code>no shutdown</code> by se na "rodičovském" interface nemělo nic konfigurovat</li>
<li>Řeší nedostatek fyzických rozhraní u Legacy architektury</li>
<li>Stejný problém s rychlostí jako u Legacy, teoreticky ještě pomalejší</li>
</ul>
<h2 id="l3-switch">L3 switch</h2>
<p><img src="./img/HW_06_03.PNG" alt="l3switch"></p>
<ul>
<li>Vícevrstvý switch kromě klasického přepínání na druhé vrstvě nabízí i funkce na vyšších vrstvách</li>
<li>Například umožňuje směrování, tyto switche jsou často nazývány L3 switch</li>
<li>Směrování oproti routeru bývá realizováno hardwarově – rychlejší, dražší</li>
<li>Mají obvykle omezenou směrovací tabulku</li>
<li>Mívá pouze Ethernet porty (RJ-45/optika), žádné sériové porty apod.</li>
<li>U Cisco L3 switchů se inter-VLAN nastavuje jednoduše:<ol>
<li>Zapnout routování</li>
<li>Pro VLAN, které chceme routovat, vytvořit interface a nastavit jim IP adresu</li>
</ol>
</li>
</ul>
<pre><code class="lang-txt hljs "><span class="hljs-keyword">Switch</span>(config)<span class="hljs-comment"># ip routing                                  // Defaultně pouze L2 přepínání, vlastnost IP routing se musí zapnout</span>
<span class="hljs-keyword">Switch</span>(config)<span class="hljs-comment"># interface vlan 10                           // Čísla VLAN se musí shodovat na obou stranách trunku</span>
<span class="hljs-keyword">Switch</span>(config-<span class="hljs-keyword">if</span>)<span class="hljs-comment"># ip address 172.17.30.1 255.255.255.0</span>
<span class="hljs-keyword">Switch</span>(config-<span class="hljs-keyword">if</span>)<span class="hljs-comment"># no sh</span>
</code></pre>
<ul>
<li>Problém s připojením do internetu:<ul>
<li>L3 switch nemá NAT server (kromě nejdražších z řady Cisco Nexus)</li>
<li>Pro připojení do internetu by se za L3 switch musel umístit router s NAT serverem<ul>
<li>Pakety určené do internetu by nepatřily do žádné jeho VLAN, pro jejich odeslání na router by se nastavila defaultní routa (žolík) <code>ip route 0.0.0.0 0.0.0.0 ...</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div></body>                            </html>